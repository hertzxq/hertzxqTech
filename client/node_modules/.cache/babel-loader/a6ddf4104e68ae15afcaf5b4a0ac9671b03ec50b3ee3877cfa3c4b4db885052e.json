{"ast":null,"code":"import React,{useState,useEffect}from'react';import Header from\"../main/header\";import Footer from\"../main/footer\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function Bin(){const[cartItems,setCartItems]=useState([]);// Функция для загрузки товаров из localStorage при загрузке компонента\nuseEffect(()=>{const storedCartItems=localStorage.getItem('cartItems');if(storedCartItems){setCartItems(JSON.parse(storedCartItems));}},[]);const handleRemoveItem=index=>{const newCartItems=[...cartItems];newCartItems.splice(index,1);setCartItems(newCartItems);localStorage.setItem('cartItems',JSON.stringify(newCartItems));};const getTotalPrice=()=>{return cartItems.reduce((total,item)=>{const price=parseFloat(item.price);if(isNaN(price)){console.error(\"Invalid price for item \".concat(item.title,\": \").concat(item.price));return total;}return total+price*item.quantity;},0);};const handleCheckout=async()=>{const token=localStorage.getItem('token');if(!token){alert('No token found. Please log in first.');return;}try{const response=await fetch('http://localhost:5000/order',{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(token)},body:JSON.stringify({items:cartItems})});if(response.ok){alert('Order placed successfully');localStorage.removeItem('cartItems');// Clear the cart\nsetCartItems([]);}else{const errorData=await response.json();alert('Error placing order: '+errorData.error);}}catch(error){alert('Error placing order: '+error.message);}};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsx(\"div\",{className:\"cart-container\",children:cartItems.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"empty-cart-message\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"binEmpty\",children:\"\\u0412\\u0430\\u0448\\u0430 \\u043A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0430 \\u043F\\u0443\\u0441\\u0442\\u0430\"}),/*#__PURE__*/_jsx(\"p\",{className:\"binSubtitle\",children:\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u044C\\u0442\\u0435 \\u0442\\u043E\\u0432\\u0430\\u0440\\u044B \\u0432 \\u043A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0443, \\u0447\\u0442\\u043E\\u0431\\u044B \\u0443\\u0432\\u0438\\u0434\\u0435\\u0442\\u044C \\u0438\\u0445 \\u0437\\u0434\\u0435\\u0441\\u044C.\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"cart-title\",children:\"\\u0412\\u0430\\u0448\\u0430 \\u043A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0430\"}),cartItems.map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"cart-item\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"cart-item-image\",children:/*#__PURE__*/_jsx(\"img\",{src:item.mainImageSrc,alt:item.title})}),/*#__PURE__*/_jsxs(\"div\",{className:\"cart-item-details\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"cart-item-name\",children:item.title}),/*#__PURE__*/_jsxs(\"p\",{className:\"cart-item-price\",children:[\"\\u0426\\u0435\\u043D\\u0430: \",item.price,\" \\u0440\\u0443\\u0431.\"]}),/*#__PURE__*/_jsx(\"button\",{className:\"cart-item-remove\",onClick:()=>handleRemoveItem(index),children:\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\"})]})]},index)),/*#__PURE__*/_jsxs(\"div\",{className:\"cart-total\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"cart-total-title\",children:\"\\u0418\\u0442\\u043E\\u0433\\u043E:\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"cart-total-price\",children:[getTotalPrice(),\" \\u0440\\u0443\\u0431.\"]}),/*#__PURE__*/_jsx(\"button\",{className:\"cart-checkout-button\",onClick:handleCheckout,children:\"\\u041F\\u0435\\u0440\\u0435\\u0439\\u0442\\u0438 \\u043A \\u043E\\u0444\\u043E\\u0440\\u043C\\u043B\\u0435\\u043D\\u0438\\u044E\"})]})]})}),/*#__PURE__*/_jsx(Footer,{})]});}","map":{"version":3,"names":["React","useState","useEffect","Header","Footer","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Bin","cartItems","setCartItems","storedCartItems","localStorage","getItem","JSON","parse","handleRemoveItem","index","newCartItems","splice","setItem","stringify","getTotalPrice","reduce","total","item","price","parseFloat","isNaN","console","error","concat","title","quantity","handleCheckout","token","alert","response","fetch","method","headers","body","items","ok","removeItem","errorData","json","message","children","className","length","map","src","mainImageSrc","alt","onClick"],"sources":["C:/Users/bomsh/Documents/hertzxqTech/client/src/components/bin/bin.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport Header from \"../main/header\";\r\nimport Footer from \"../main/footer\";\r\n\r\nexport default function Bin() {\r\n    const [cartItems, setCartItems] = useState([]);\r\n\r\n    // Функция для загрузки товаров из localStorage при загрузке компонента\r\n    useEffect(() => {\r\n        const storedCartItems = localStorage.getItem('cartItems');\r\n        if (storedCartItems) {\r\n            setCartItems(JSON.parse(storedCartItems));\r\n        }\r\n    }, []);\r\n\r\n    const handleRemoveItem = (index) => {\r\n        const newCartItems = [...cartItems];\r\n        newCartItems.splice(index, 1);\r\n        setCartItems(newCartItems);\r\n        localStorage.setItem('cartItems', JSON.stringify(newCartItems));\r\n    };\r\n\r\n    const getTotalPrice = () => {\r\n        return cartItems.reduce((total, item) => {\r\n            const price = parseFloat(item.price);\r\n            if (isNaN(price)) {\r\n                console.error(`Invalid price for item ${item.title}: ${item.price}`);\r\n                return total;\r\n            }\r\n            return total + price * item.quantity;\r\n        }, 0);\r\n    };\r\n\r\n    const handleCheckout = async () => {\r\n        const token = localStorage.getItem('token');\r\n        if (!token) {\r\n            alert('No token found. Please log in first.');\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const response = await fetch('http://localhost:5000/order', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                    'Authorization': `Bearer ${token}`,\r\n                },\r\n                body: JSON.stringify({ items: cartItems }),\r\n            });\r\n\r\n            if (response.ok) {\r\n                alert('Order placed successfully');\r\n                localStorage.removeItem('cartItems'); // Clear the cart\r\n                setCartItems([]);\r\n            } else {\r\n                const errorData = await response.json();\r\n                alert('Error placing order: ' + errorData.error);\r\n            }\r\n        } catch (error) {\r\n            alert('Error placing order: ' + error.message);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <Header />\r\n            <div className=\"cart-container\">\r\n                {cartItems.length === 0 ? (\r\n                    <div className=\"empty-cart-message\">\r\n                        <h2 className='binEmpty'>Ваша корзина пуста</h2>\r\n                        <p className='binSubtitle'>Добавьте товары в корзину, чтобы увидеть их здесь.</p>\r\n                    </div>\r\n                ) : (\r\n                    <>\r\n                        <h1 className=\"cart-title\">Ваша корзина</h1>\r\n                        {cartItems.map((item, index) => (\r\n                            <div className=\"cart-item\" key={index}>\r\n                                <div className=\"cart-item-image\">\r\n                                    <img src={item.mainImageSrc} alt={item.title} />\r\n                                </div>\r\n                                <div className=\"cart-item-details\">\r\n                                    <h2 className=\"cart-item-name\">{item.title}</h2>\r\n                                    <p className=\"cart-item-price\">Цена: {item.price} руб.</p>\r\n                                    <button className=\"cart-item-remove\" onClick={() => handleRemoveItem(index)}>Удалить</button>\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                        <div className=\"cart-total\">\r\n                            <h3 className=\"cart-total-title\">Итого:</h3>\r\n                            <p className=\"cart-total-price\">{getTotalPrice()} руб.</p>\r\n                            <button className=\"cart-checkout-button\" onClick={handleCheckout}>Перейти к оформлению</button>\r\n                        </div>\r\n                    </>\r\n                )}\r\n            </div>\r\n            <Footer />\r\n        </>\r\n    );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}